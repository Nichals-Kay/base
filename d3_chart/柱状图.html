<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="Generator" content="EditPlus®">
  <meta name="Author" content="">
  <meta name="Keywords" content="">
  <meta name="Description" content="">
  <title>D3绘制柱状图</title>
 </head>
 <body>
	<div id='demo'></div>
 </body>
 <script src='./d3/d3.js'></script>
 <script>
 	var width = 640;
	var height = 480;
	//创建svg，在body上添加画布
	var svg = d3.select('body')
				.append('svg')
				.attr('width', width)
				.attr('height', height);
	// 设置画布周边的内边距
	var padding = {left:30, right: 20, top: 25, bottom: 35};
	//定义一个数组
	var dataset = [10, 30, 20, 45, 28, 52, 43];
	//设置x轴比例尺
	var xScale = d3.scale.ordinal()
		.domain(d3.range(dataset.length))
		.rangeRoundBands([0, width - padding.left - padding.right]);
	//定义x轴
	var xAxis = d3.svg.axis().scale(xScale).orient('bottom');
	//设置y轴比例尺
	var yScale = d3.scale.linear()
		.domain([0, d3.max(dataset)])
		.range([height- padding.top - padding.bottom, 0]);
	//定义y轴
	var yAxis = d3.svg.axis().scale(yScale).orient('left');
	var rectPadding = 10; //每个矩形块之间的距离
	//添加矩形元素
	var rects = svg.selectAll('.myRect')
		.data(dataset)
		.enter()
		.append('rect')
		.attr('class', 'myRect')
		.attr('fill', 'skyblue')
		.attr('transform', 'translate(' + padding.left + ',' + padding.top + ')')
		.attr('x', function(d,i){
			return Math.floor(xScale(i)) 
		})
		.attr('y', function(d){
			return yScale(d);
		})
		.attr('width', Math.floor(xScale(1) - rectPadding))
		.attr('height', function(d){
			return  height - padding.top - padding.bottom - yScale(d);
		});
	//添加文字元素
	var texts = svg.selectAll('.myText')
		.data(dataset)
		.enter()
		.append('text')
		.attr('class', 'myText')
		.attr('fill', 'black')
		.attr('transform', 'translate(' + padding.left + ',' + padding.top + ')')
		.attr('x', function(d, i){
			return Math.floor(xScale(i));
		})
		.attr('y', function(d){
			return yScale(d);
		})
		.attr('dx', function(d, i){
			return Math.floor((width - padding.left - padding.right) / 7) - rectPadding * 6 ;
		})
		.attr('dy', function(d){
			return 30;
		})
		.text(function(d){
			return d;
		});
	//将x轴添加到页面上
	svg.append('g')
		.attr('class', 'axis')
		.attr('fill', 'red')
		.attr("transform", "translate(" + padding.left + "," + (height - padding.bottom) + ")")
		.call(xAxis);
	//将y轴添加到页面上
	svg.append('g')
		.attr('class', 'axis')
		.attr('fill', 'green')
		.attr('transform', 'translate(' + padding.left + "," + padding.top + ")")
		.call(yAxis);
 </script>
</html>
